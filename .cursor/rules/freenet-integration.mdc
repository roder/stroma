---
description: Freenet embedded kernel and contract development with ComposableState
globs: **/*freenet*.rs,**/*contract*.rs,**/*wasm*.rs,**/*state*.rs,**/*kernel*.rs
alwaysApply: false
---

# Freenet Integration Standards

**Canonical Source**: `.beads/freenet-integration.bead`

The complete Freenet node embedding architecture, testing patterns, two-layer architecture, state stream monitoring, and federation logic are defined in the freenet-integration bead. Read that file for complete specifications.

## Key Architecture

- **Embedded Node**: Freenet runs in-process (not external service)
- **Crates**: `freenet` (node), `freenet-stdlib` (contracts)
- **Real-Time Stream**: Never poll, use state stream subscription
- **Two Layers**: Trust state (Freenet-native) + Persistence (encrypted chunks)

## Entry Points

| Use Case | API |
|----------|-----|
| Production | `NodeConfig::build()` |
| Integration test | `SimNetwork` |
| Unit test | `Executor::new_mock_in_memory()` |

## Federation (BidirectionalMin)

Both groups independently evaluate overlap against their own threshold. Both must approve for federation to proceed.

## Related Beads

- `.beads/freenet-contract-design.bead` - Contract patterns
- `.beads/persistence-model.bead` - Chunk storage
- `.beads/discovery-protocols.bead` - Shadow Beacon discovery
