---
description: Critical security constraints that all Stroma code must follow - violations are blocking
alwaysApply: true
---

# Security & Quality Guardrails

**Canonical Source**: `.beads/security-constraints.bead`

All security constraints, threat models, trust model enforcement rules, privacy requirements, and verification patterns are defined in the security constraints bead. Read that file for complete specifications.

## Threat Model Summary

**Primary Threat**: Trust map seizure by state-level adversary or compromised operator.

**Three-Layer Defense** (ALL required):
1. **No Centralized Storage**: Freenet distributed (no single seizure point)
2. **Cryptographic Privacy**: Only hashes in memory (immediate zeroization)
3. **Metadata Isolation**: 1-on-1 PMs, operator least-privilege

## The Eight Absolutes

1. **NEVER** store Signal IDs in cleartext
2. **NEVER** persist message history
3. **NEVER** bypass ZK-proof verification
4. **NEVER** add grace periods for ejection
5. **NEVER** make Signal source of truth
6. **NEVER** restrict vouching to Validators only
7. **NEVER** commit without Co-authored-by (AI agents)
8. **NEVER** trust persistence peers

## Critical Violations (BLOCK)

Any code that violates these is **rejected immediately**:
- Cleartext Signal ID storage or logging
- Grace periods or warnings before ejection
- Polling instead of real-time state stream
- Same-cluster vouching counting toward admission
- 2-point standing swings from single member's action
- Default SqliteStore usage (stores message history)
- Operator manual execution of trust operations

## Related Beads

- `.beads/cross-cluster-requirement.bead` - Infiltration prevention
- `.beads/persistence-model.bead` - Chunk storage security
- `.beads/contract-encryption.bead` - Encryption key derivation
