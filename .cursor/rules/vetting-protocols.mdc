---
description: Vetting and admission protocols for Stroma trust network
globs: **/*vetting*.rs,**/*admission*.rs,**/*matchmaker*.rs,**/*ejection*.rs
alwaysApply: false
---

# Vetting Protocols

**Canonical Source**: `.beads/vetting-protocols.bead`

## Related Beads (Read These)

| Topic | Bead |
|-------|------|
| Terminology | `terminology.bead` |
| Cross-Cluster | `cross-cluster-requirement.bead` |
| Bootstrap | `bootstrap-seed.bead` |
| Blind Matchmaker | `blind-matchmaker-dvr.bead` |
| Mesh Health | `mesh-health-metric.bead` |
| Security/Ejection | `security-constraints.bead` |
| Decisions | `architectural-decisions-open.bead` |

## Core Invariant

Signal Group = Fully Vetted Members Only

## Admission Flow (PM-Only)

1. Member sends `/invite @invitee "context"` via PM
2. Bot selects cross-cluster **assessor** (bridge or validator) via DVR-optimized algorithm
3. Bot PMs assessor with invitee contact info (inviter identity NOT revealed)
4. Assessor independently contacts invitee; decides how to approach
5. Assessor sends `/vouch @invitee` or `/reject-intro @invitee`
6. If rejected: bot selects new assessor (excluding declined members)
7. If vouched + GroupConfig thresholds met: STARK proof, add to group, delete session

**Critical**: Bot belongs to ONE Signal group. No 3-person chats. Assessor contacts invitee independently.

## Two Blind Matchmaker Roles

- **Admission Vetting** (`signal/matchmaker.rs`): Assessor selection for invitees
- **Mesh Optimization** (`matchmaker/strategic_intro.rs`): Introductions between existing members

## Ejection Triggers (Two Independent)

1. `Standing < 0` (Effective_Vouches - Regular_Flags < 0)
2. `Effective_Vouches < config.min_vouch_threshold` (voucher left OR voucher flagged)

**No Grace Periods**: Immediate ejection when threshold violated.

## Anti-Patterns

- ❌ Restricting vouching to Validators only
- ❌ Adding grace periods or warnings
- ❌ Polling instead of state stream
- ❌ Storing Signal IDs in cleartext
- ❌ Persisting vetting data after admission
- ❌ Creating 3-person chats or secondary Signal groups
- ❌ Bot contacting invitees directly
- ❌ Revealing inviter identity to assessor
- ❌ Hardcoding admission threshold (use GroupConfig)
- ❌ Mixing admission vetting code with mesh optimization code
